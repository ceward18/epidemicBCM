geom_hline(aes(yintercept = truth), col = 'red', linetype = 2) +
facet_wrap(~param + smoothWindow, nrow = 2, scales = 'free_y') +
theme_bw()
### power alarm
ggplot(data = subset(paramsPostAll, alarmFit == 'power'),
aes(x = simNumber, y = mean)) +
geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.9,
position = position_dodge2(preserve = "single", width = 0.9)) +
geom_hline(aes(yintercept = truth), col = 'red', linetype = 2) +
facet_wrap(~param + smoothWindow, nrow = 2, scales = 'free_y') +
theme_bw()
### power alarm
ggplot(data = subset(paramsPostAll, alarmFit == 'power'),
aes(x = simNumber, y = mean)) +
geom_point(position = position_dodge2(preserve = "single", width = 0.9)) +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.9,
position = position_dodge2(preserve = "single", width = 0.9)) +
geom_hline(aes(yintercept = truth), col = 'red', linetype = 2) +
facet_wrap(~param + smoothWindow, nrow = 2, scales = 'free_y') +
theme_bw()
### power alarm
ggplot(data = subset(paramsPostAll, alarmFit == 'power'),
aes(x = simNumber, y = mean)) +
geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.9,
position = position_dodge(width = 0.9)) +
geom_hline(aes(yintercept = truth), col = 'red', linetype = 2) +
facet_wrap(~param + smoothWindow, nrow = 2, scales = 'free_y') +
theme_bw()
?facet_wrap
### power alarm
ggplot(data = subset(paramsPostAll, alarmFit == 'power'),
aes(x = simNumber, y = mean)) +
geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.9,
position = position_dodge(width = 0.9)) +
geom_hline(aes(yintercept = truth), col = 'red', linetype = 2) +
facet_wrap(~param + smoothWindow, nrow = 2, scales = 'free_y',
labeller = "label_both") +
theme_bw() +
labs
### power alarm
ggplot(data = subset(paramsPostAll, alarmFit == 'power'),
aes(x = simNumber, y = mean)) +
geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.9,
position = position_dodge(width = 0.9)) +
geom_hline(aes(yintercept = truth), col = 'red', linetype = 2) +
facet_wrap(~param + smoothWindow, nrow = 2, scales = 'free_y',
labeller = "label_both") +
theme_bw() +
labs(x = 'Simulation Number', y = '')
### power alarm
ggplot(data = subset(paramsPostAll, alarmFit == 'power'),
aes(x = simNumber, y = mean)) +
geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.9,
position = position_dodge(width = 0.9)) +
geom_hline(aes(yintercept = truth), col = 'red', linetype = 2) +
facet_wrap(~param + smoothWindow, nrow = 2, scales = 'free_y',
labeller = "label_both") +
theme_bw() +
labs(x = 'Simulation Number', y = '') +
theme(strip.background = element_rect(fill = 'white'))
### power alarm
ggplot(data = subset(paramsPostAll, alarmFit == 'power'),
aes(x = simNumber, y = mean)) +
geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.9,
position = position_dodge(width = 0.9)) +
geom_hline(aes(yintercept = truth), col = 'red', linetype = 2) +
facet_wrap(~param + smoothWindow, nrow = 2, scales = 'free_y',
labeller = "label_both") +
theme_bw() +
labs(x = 'Simulation Number', y = '') +
theme(strip.background = element_rect(fill = 'white'),
strip.text = element_text(size = 12))
### power alarm
ggplot(data = subset(paramsPostAll, alarmFit == 'power'),
aes(x = simNumber, y = mean)) +
geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.9,
position = position_dodge(width = 0.9)) +
geom_hline(aes(yintercept = truth), col = 'red', linetype = 2) +
facet_wrap(~param + smoothWindow, nrow = 2, scales = 'free_y',
labeller = "label_both") +
theme_bw() +
labs(x = 'Simulation Number', y = '') +
theme(strip.background = element_rect(fill = 'white'),
strip.text = element_text(size = 12),
axis.title = element_text(size = 14),
axis.text = element_text(size = 12))
### power alarm
ggplot(data = subset(paramsPostAll, alarmFit == 'power'),
aes(x = simNumber, y = mean)) +
geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.9,
position = position_dodge(width = 0.9)) +
geom_hline(aes(yintercept = truth), col = 'red', linetype = 2) +
facet_wrap(~param + smoothWindow, nrow = 2, scales = 'free_y',
labeller = "label_both") +
theme_bw() +
labs(x = 'Simulation Number', y = '') +
theme(strip.background = element_rect(fill = 'white'),
strip.text = element_text(size = 12),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
### threshold alarm
ggplot(data = subset(paramsPostAll, alarmFit == 'thresh'),
aes(x = simNumber, y = mean)) +
geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.9,
position = position_dodge(width = 0.9)) +
geom_hline(aes(yintercept = truth), col = 'red', linetype = 2) +
facet_wrap(~param + smoothWindow, nrow = 2, scales = 'free_y',
labeller = "label_both") +
theme_bw() +
labs(x = 'Simulation Number', y = '') +
theme(strip.background = element_rect(fill = 'white'),
strip.text = element_text(size = 12),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
### hill alarm
ggplot(data = subset(paramsPostAll, alarmFit == 'hill'),
aes(x = simNumber, y = mean)) +
geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.9,
position = position_dodge(width = 0.9)) +
geom_hline(aes(yintercept = truth), col = 'red', linetype = 2) +
facet_wrap(~param + smoothWindow, nrow = 2, scales = 'free_y',
labeller = "label_both") +
theme_bw() +
labs(x = 'Simulation Number', y = '') +
theme(strip.background = element_rect(fill = 'white'),
strip.text = element_text(size = 12),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
### power alarm
ggplot(data = subset(paramsPostAll, alarmFit == 'power'),
aes(x = simNumber, y = mean)) +
geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.9,
position = position_dodge(width = 0.9)) +
geom_hline(aes(yintercept = truth), col = 'red', linetype = 2) +
facet_wrap(~param + smoothWindow, nrow = 2, scales = 'free_y',
labeller = "label_both") +
theme_bw() +
labs(x = 'Simulation Number', y = '') +
theme(strip.background = element_rect(fill = 'white'),
strip.text = element_text(size = 12),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
### power alarm
ggplot(data = subset(paramsPostAll, alarmFit == 'power'),
aes(x = simNumber, y = mean)) +
geom_point() +
geom_errorbar(aes(ymin=lower, ymax=upper), width=.9,
position = position_dodge(width = 0.9)) +
geom_hline(aes(yintercept = truth), col = 'red', linetype = 2) +
facet_wrap(~param + smoothWindow, nrow = 2, scales = 'free_y',
labeller = "label_both") +
theme_bw() +
labs(x = 'Simulation Number', y = '') +
theme(strip.background = element_rect(fill = 'white'),
strip.text = element_text(size = 12),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
head(paramsTruth)
### get true alarms
paramsTruth <- read.xlsx('simParamsSummary.xlsx')
paramsTruth <- paramsTruth[paramsTruth$modelType == 'Fixed',]
head(paramsTruth)
# functions to calculate the alarms
source('./scripts/modelCodes.R')
library(nimble)
# functions to calculate the alarms
source('./scripts/modelCodes.R')
### load posterior estimates
alarmAll <- readRDS('./resultsFinal/alarmPostAll.rds')
head(alarmAll)
max(alarmAll$xAlarm)
?thresholdAlarm
thresholdAlarm
paramsTruth$delta[
(paramsTruth$alarmGen == 'thresh' &
paramsTruth$smoothWindow == 14),]
paramsTruth$delta[
(paramsTruth$alarmGen == 'thresh' &
paramsTruth$smoothWindow == 14)]
paramsTruth
paramsTruth$H[
(paramsTruth$alarmGen == 'thresh' &
paramsTruth$smoothWindow == 14)]
hillAlarm
hillAlarm(xAlarm, N = N,
nu = paramsTruth$nu[
(paramsTruth$alarmGen == 'hill' &
paramsTruth$smoothWindow == 14)],
x0 = paramsTruth$x0[
(paramsTruth$alarmGen == 'hill' &
paramsTruth$smoothWindow == 14)],
delta = paramsTruth$delta[
(paramsTruth$alarmGen == 'hill' &
paramsTruth$smoothWindow == 14)])
powerAlarm
N <- 1e6
xAlarm <- 0:400
trueAlarmThresh14 <- thresholdAlarm(xAlarm, N = N,
delta = paramsTruth$delta[
(paramsTruth$alarmGen == 'thresh' &
paramsTruth$smoothWindow == 14)],
H = paramsTruth$H[
(paramsTruth$alarmGen == 'thresh' &
paramsTruth$smoothWindow == 14)])
trueAlarmThresh30 <- thresholdAlarm(xAlarm, N = N,
delta = paramsTruth$delta[
(paramsTruth$alarmGen == 'thresh' &
paramsTruth$smoothWindow == 30)],
H = paramsTruth$H[
(paramsTruth$alarmGen == 'thresh' &
paramsTruth$smoothWindow == 30)])
trueAlarmHill14 <- hillAlarm(xAlarm,
nu = paramsTruth$nu[
(paramsTruth$alarmGen == 'hill' &
paramsTruth$smoothWindow == 14)],
x0 = paramsTruth$x0[
(paramsTruth$alarmGen == 'hill' &
paramsTruth$smoothWindow == 14)],
delta = paramsTruth$delta[
(paramsTruth$alarmGen == 'hill' &
paramsTruth$smoothWindow == 14)])
trueAlarmHill30 <- hillAlarm(xAlarm,
nu = paramsTruth$nu[
(paramsTruth$alarmGen == 'hill' &
paramsTruth$smoothWindow == 30)],
x0 = paramsTruth$x0[
(paramsTruth$alarmGen == 'hill' &
paramsTruth$smoothWindow == 30)],
delta = paramsTruth$delta[
(paramsTruth$alarmGen == 'hill' &
paramsTruth$smoothWindow == 30)])
trueAlarmPower14 <- powerAlarm(xAlarm, N = N,
k = paramsTruth$k[
(paramsTruth$alarmGen == 'power' &
paramsTruth$smoothWindow == 14)])
trueAlarmPower30 <- powerAlarm(xAlarm, N = N,
k = paramsTruth$k[
(paramsTruth$alarmGen == 'power' &
paramsTruth$smoothWindow == 30)])
trueAlarmPower30
rep(xAlarm, 6)
rep(14, 30), each = length(xAlarm))
rep(c(14, 30), each = length(xAlarm))
trueAlarms <- rbind.data.frame(xAlarm = rep(xAlarm, 6),
trueAlarm = c(trueAlarmThresh14,
trueAlarmThresh30,
trueAlarmHill14,
trueAlarmHill30,
trueAlarmPower14,
trueAlarmPower30),
alarmGen = c(rep('thresh', length(xAlarm)*2),
rep('hill', length(xAlarm)*2),
rep('power', length(xAlarm)*2)),
smoothWindow = rep(rep(c(14, 30), each = length(xAlarm)), 3))
head(trueAlarms)
tail(trueAlarms)
trueAlarms <- data.frame(xAlarm = rep(xAlarm, 6),
trueAlarm = c(trueAlarmThresh14,
trueAlarmThresh30,
trueAlarmHill14,
trueAlarmHill30,
trueAlarmPower14,
trueAlarmPower30),
alarmGen = c(rep('thresh', length(xAlarm)*2),
rep('hill', length(xAlarm)*2),
rep('power', length(xAlarm)*2)),
smoothWindow = rep(rep(c(14, 30), each = length(xAlarm)), 3))
head(trueAlarms)
tail(trueAlarms)
ggplot(trueAlarms, aes(x = xAlarm, y = trueAlarm)) + geom_line() + facet_wrap(~alarmGen + smoothWindow)
### load posterior estimates
alarmAll <- readRDS('./resultsFinal/alarmPostAll.rds')
head(alarmAll)
ggplot() +
geom_line(data = subset(alarmAll, smoothWindow = 14), aes(x = xAlarm, y = mean, group = simNumber)) +
facet_wrap(~alarmGen + alarmFit)
head(subset(alarmAll, smoothWindow = 14))
with(subset(alarmAll, smoothWindow = 14), table(alarmGen, alarmFit))
ggplot() +
geom_line(data = subset(alarmAll, smoothWindow = 14),
aes(x = xAlarm, y = mean, group = simNumber)) +
facet_wrap(~alarmGen + alarmFit + simNumber)
ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14),
aes(x = xAlarm, y = mean, group = simNumber)) +
facet_wrap(~alarmGen + alarmFit)
head(trueAlarms)
ggplot() +
geom_line(data = trueAlarms, aes(x = xAlarm, y = trueAlarm), col = 'red') +
geom_line(data = subset(alarmAll, smoothWindow == 14),
aes(x = xAlarm, y = mean, group = simNumber)) +
facet_wrap(~alarmGen + alarmFit)
ggplot() +
geom_line(data = subset(trueAlarms, smoothWindow == 14),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
geom_line(data = subset(alarmAll, smoothWindow == 14),
aes(x = xAlarm, y = mean, group = simNumber)) +
facet_wrap(~alarmGen + alarmFit)
ggplot() +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'thresh'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
geom_line(data = subset(alarmAll, smoothWindow == 14  & alarmGen == 'thresh'),
aes(x = xAlarm, y = mean, group = simNumber)) +
facet_wrap(~alarmFit)
### smoothing window 14 days
p1 <- ggplot() +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'thresh'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
geom_line(data = subset(alarmAll, smoothWindow == 14  & alarmGen == 'thresh'),
aes(x = xAlarm, y = mean, group = simNumber)) +
facet_wrap(~alarmFit) + theme_bw()
ggplot() +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'thresh'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
geom_line(data = subset(alarmAll, smoothWindow == 14  & alarmGen == 'thresh'),
aes(x = xAlarm, y = mean, group = simNumber)) +
facet_wrap(~alarmFit) +
theme_bw() +
theme(strip.background = element_rect(fill = 'white'),
strip.text = element_text(size = 12),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
### smoothing window 14 days
p1 <- ggplot() +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'thresh'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
geom_line(data = subset(alarmAll, smoothWindow == 14  & alarmGen == 'thresh'),
aes(x = xAlarm, y = mean, group = simNumber), col = 'grey') +
facet_wrap(~alarmFit) +
theme_bw() +
theme(strip.background = element_rect(fill = 'white'),
strip.text = element_text(size = 12),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
ggplot() +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'thresh'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
geom_line(data = subset(alarmAll, smoothWindow == 14  & alarmGen == 'thresh'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey', alpha = 0.7)) +
facet_wrap(~alarmFit) +
theme_bw() +
theme(strip.background = element_rect(fill = 'white'),
strip.text = element_text(size = 12),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
### smoothing window 14 days
p1 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14  & alarmGen == 'thresh'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey', alpha = 0.7)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'thresh'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
theme_bw() +
theme(strip.background = element_rect(fill = 'white'),
strip.text = element_text(size = 12),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14  & alarmGen == 'thresh'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('black', alpha = 0.7)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'thresh'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
theme_bw() +
theme(strip.background = element_rect(fill = 'white'),
strip.text = element_text(size = 12),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14  & alarmGen == 'thresh'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey80', alpha = 0.7)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'thresh'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
theme_bw() +
theme(strip.background = element_rect(fill = 'white'),
strip.text = element_text(size = 12),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14  & alarmGen == 'thresh'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey20', alpha = 0.7)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'thresh'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
theme_bw() +
theme(strip.background = element_rect(fill = 'white'),
strip.text = element_text(size = 12),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14  & alarmGen == 'thresh'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.7)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'thresh'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
theme_bw() +
theme(strip.background = element_rect(fill = 'white'),
strip.text = element_text(size = 12),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14  & alarmGen == 'thresh'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'thresh'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
theme_bw() +
theme(strip.background = element_rect(fill = 'white'),
strip.text = element_text(size = 12),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
library(gridExtra)
### smoothing window 14 days
p1 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14  & alarmGen == 'thresh'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'thresh'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
theme_bw() +
theme(strip.background = element_rect(fill = 'white'),
strip.text = element_text(size = 12),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
p2 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14  & alarmGen == 'hill'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'hill'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
theme_bw() +
theme(strip.background = element_rect(fill = 'white'),
strip.text = element_text(size = 12),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
p3 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14  & alarmGen == 'power'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'power'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
theme_bw() +
theme(strip.background = element_rect(fill = 'white'),
strip.text = element_text(size = 12),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
grid.arrange(p1, p2, p3, nrow = 3)
factor(alarmAll$alarmFit)
alarmAll$alarmFit <- factor(alarmAll$alarmFit,
levels = c('spline', 'gp', 'thresh', 'hill', 'power'),
labels = c('Spline', 'Gaussian Process',
'Threshold', 'Hill', 'Power'))
### smoothing window 14 days
p1 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14  & alarmGen == 'thresh'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'thresh'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
theme_bw() +
theme(strip.background = element_rect(fill = 'white'),
strip.text = element_text(size = 12),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
p2 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14  & alarmGen == 'hill'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'hill'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
theme_bw() +
theme(strip.background = element_rect(fill = 'white'),
strip.text = element_text(size = 12),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
p3 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14  & alarmGen == 'power'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'power'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
theme_bw() +
theme(strip.background = element_rect(fill = 'white'),
strip.text = element_text(size = 12),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10))
grid.arrange(p1, p2, p3, nrow = 3)
