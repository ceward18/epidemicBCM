facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm') +
ylim(0, 1)
p2 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 & alarmGen == 'hill'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'hill'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm')+
ylim(0, 1)
p3 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 & alarmGen == 'power'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'power'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm')+
ylim(0, 1)
grid.arrange(p1, p2, p3, nrow = 3,
top=textGrob("14-day smoothing", gp = gpar(fontsize = 18, font = 1)))
### load posterior estimates
alarmAll <- readRDS('./resultsFinal/alarmPostAll.rds')
# format for better plotting
alarmAll$alarmFit <- factor(alarmAll$alarmFit,
levels = c('thresh', 'hill', 'power', 'spline', 'gp'),
labels = c('Threshold', 'Hill', 'Power',
'Spline', 'Gaussian Process'))
### smoothing window 14 days
p1 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 &  alarmGen == 'thresh'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'thresh'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm') +
ylim(0, 1)
p2 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 & alarmGen == 'hill'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'hill'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm')+
ylim(0, 1)
p3 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 & alarmGen == 'power'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'power'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm')+
ylim(0, 1)
grid.arrange(p1, p2, p3, nrow = 3,
top=textGrob("14-day smoothing", gp = gpar(fontsize = 18, font = 1)))
pdf('./Figures/sim_alarms14.pdf', height = 6, width = 6)
grid.arrange(p1, p2, p3, nrow = 3,
top=textGrob("14-day smoothing", gp = gpar(fontsize = 18, font = 1)))
dev.off()
pdf('./Figures/sim_alarms14.pdf', height = 7, width = 7)
grid.arrange(p1, p2, p3, nrow = 3,
top=textGrob("14-day smoothing", gp = gpar(fontsize = 18, font = 1)))
dev.off()
pdf('./Figures/sim_alarms14.pdf', height = 7, width = 7)
grid.arrange(p1, p2, p3, nrow = 3,
top=textGrob("14-day smoothing", gp = gpar(fontsize = 18, font = 1)))
dev.off()
grid.arrange(p1, p2, p3, nrow = 3,
top=textGrob("Posterior Mean Alarm Functions", gp = gpar(fontsize = 18, font = 1)))
p3 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 & alarmGen == 'power'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'power'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm')+
ylim(0, 1) +
ggtitle('Power Alarm')
grid.arrange(p1, p2, p3, nrow = 3,
top=textGrob("Alarm Functions Posterior Mean", gp = gpar(fontsize = 18, font = 1)))
### smoothing window 14 days
p1 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 & alarmGen == 'power'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'power'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm')+
ylim(0, 1) +
ggtitle('Power Alarm')
p2 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 &  alarmGen == 'thresh'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'thresh'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm') +
ylim(0, 1)  +
ggtitle('Threshold Alarm')
p3 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 & alarmGen == 'hill'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'hill'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm')+
ylim(0, 1)  +
ggtitle('Hill Alarm')
grid.arrange(p1, p2, p3, nrow = 3,
top=textGrob("Alarm Functions Posterior Mean", gp = gpar(fontsize = 18, font = 1)))
pdf('./Figures/sim_alarms14.pdf', height = 9, width = 7)
grid.arrange(p1, p2, p3, nrow = 3,
top=textGrob("Alarm Functions Posterior Mean", gp = gpar(fontsize = 18, font = 1)))
dev.off()
pdf('./Figures/sim_alarms14.pdf', height = 9, width = 7)
grid.arrange(p1, p2, p3, nrow = 3,
top=textGrob("Alarm Functions Posterior Mean", gp = gpar(fontsize = 18, font = 1)))
dev.off()
### smoothing window 14 days
p1 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 & alarmGen == 'power'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'power'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm')+
ylim(0, 1) +
ggtitle('Power Alarm')+
theme(plot.title = element_text(size = 17))
p2 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 &  alarmGen == 'thresh'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'thresh'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm') +
ylim(0, 1)  +
ggtitle('Threshold Alarm')+
theme(plot.title = element_text(size = 17))
p3 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 & alarmGen == 'hill'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'hill'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm')+
ylim(0, 1)  +
ggtitle('Hill Alarm') +
theme(plot.title = element_text(size = 17))
pdf('./Figures/sim_alarms14.pdf', height = 7, width = 7)
grid.arrange(p1, p2, p3, nrow = 3,
top=textGrob("Alarm Functions Posterior Mean", gp = gpar(fontsize = 18, font = 1)))
dev.off()
theme_set(theme_bw() +
theme(strip.background = element_rect(fill = 'white'),
strip.text = element_text(size = 16),
axis.title = element_text(size = 16),
axis.text = element_text(size = 14),
plot.title = element_text(size = 17), h = 0.5))
### smoothing window 14 days
p1 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 & alarmGen == 'power'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'power'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm')+
ylim(0, 1) +
ggtitle('Power Alarm')
p2 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 &  alarmGen == 'thresh'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'thresh'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm') +
ylim(0, 1)  +
ggtitle('Threshold Alarm')
p3 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 & alarmGen == 'hill'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'hill'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm')+
ylim(0, 1)  +
ggtitle('Hill Alarm')
pdf('./Figures/sim_alarms14.pdf', height = 8, width = 7)
grid.arrange(p1, p2, p3, nrow = 3,
top=textGrob("Alarm Functions Posterior Mean", gp = gpar(fontsize = 18, font = 1)))
dev.off()
theme_set(theme_bw() +
theme(strip.background = element_rect(fill = 'white'),
strip.text = element_text(size = 16),
axis.title = element_text(size = 16),
axis.text = element_text(size = 14),
plot.title = element_text(size = 17, h = 0.5)))
### smoothing window 14 days
p1 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 & alarmGen == 'power'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'power'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm')+
ylim(0, 1) +
ggtitle('Power Alarm')
p2 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 &  alarmGen == 'thresh'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'thresh'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm') +
ylim(0, 1)  +
ggtitle('Threshold Alarm')
p3 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 & alarmGen == 'hill'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'hill'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm')+
ylim(0, 1)  +
ggtitle('Hill Alarm')
pdf('./Figures/sim_alarms14.pdf', height = 8, width = 7)
grid.arrange(p1, p2, p3, nrow = 3,
top=textGrob("Alarm Functions Posterior Mean", gp = gpar(fontsize = 18, font = 1)))
dev.off()
### smoothing window 14 days
p1 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 & alarmGen == 'power'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'power'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm')+
ylim(0, 1) +
ggtitle('Power Alarm')
p2 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 &  alarmGen == 'thresh'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'thresh'),
aes(x = xAlarm, y = trueAlarm), col = 'red') +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm') +
ylim(0, 1)  +
ggtitle('Threshold Alarm')
p3 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 & alarmGen == 'hill'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'hill'),
aes(x = xAlarm, y = trueAlarm), col = 'blue') +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm')+
ylim(0, 1)  +
ggtitle('Hill Alarm')
pdf('./Figures/sim_alarms14.pdf', height = 8, width = 7)
grid.arrange(p1, p2, p3, nrow = 3,
top=textGrob("Alarm Functions Posterior Mean", gp = gpar(fontsize = 18, font = 1)))
dev.off()
ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 & alarmGen == 'hill'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'hill'),
aes(x = xAlarm, y = trueAlarm), col = 'red', size = 1) +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm')+
ylim(0, 1)  +
ggtitle('Hill Alarm')
### smoothing window 14 days
p1 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 & alarmGen == 'power'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'power'),
aes(x = xAlarm, y = trueAlarm), col = 'red', size = 1) +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm')+
ylim(0, 1) +
ggtitle('Power Alarm')
p2 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 &  alarmGen == 'thresh'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'thresh'),
aes(x = xAlarm, y = trueAlarm), col = 'red', size = 1) +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm') +
ylim(0, 1)  +
ggtitle('Threshold Alarm')
p3 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 & alarmGen == 'hill'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'hill'),
aes(x = xAlarm, y = trueAlarm), col = 'red', size = 1) +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm')+
ylim(0, 1)  +
ggtitle('Hill Alarm')
pdf('./Figures/sim_alarms14.pdf', height = 8, width = 7)
grid.arrange(p1, p2, p3, nrow = 3,
top=textGrob("Alarm Functions Posterior Mean", gp = gpar(fontsize = 18, font = 1)))
dev.off()
theme_set(theme_bw() +
theme(strip.background = element_rect(fill = 'white'),
strip.text = element_text(size = 14),
axis.title = element_text(size = 14),
axis.text = element_text(size = 12),
plot.title = element_text(size = 16, h = 0.5)))
### smoothing window 14 days
p1 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 & alarmGen == 'power'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'power'),
aes(x = xAlarm, y = trueAlarm), col = 'red', size = 1) +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm')+
ylim(0, 1) +
ggtitle('Power Alarm')
p2 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 &  alarmGen == 'thresh'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'thresh'),
aes(x = xAlarm, y = trueAlarm), col = 'red', size = 1) +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm') +
ylim(0, 1)  +
ggtitle('Threshold Alarm')
p3 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 & alarmGen == 'hill'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'hill'),
aes(x = xAlarm, y = trueAlarm), col = 'red', size = 1) +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm')+
ylim(0, 1)  +
ggtitle('Hill Alarm')
pdf('./Figures/sim_alarms14.pdf', height = 7, width = 5)
grid.arrange(p1, p2, p3, nrow = 3,
top=textGrob("Alarm Functions Posterior Mean", gp = gpar(fontsize = 18, font = 1)))
dev.off()
theme_set(theme_bw() +
theme(strip.background = element_rect(fill = 'white'),
strip.text = element_text(size = 14),
axis.title = element_text(size = 14),
axis.text = element_text(size = 12),
plot.title = element_text(size = 16, h = 0.5)))
### smoothing window 14 days
p1 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 & alarmGen == 'power'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'power'),
aes(x = xAlarm, y = trueAlarm), col = 'red', size = 1) +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm')+
ylim(0, 1) +
ggtitle('Power Alarm')
p2 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 &  alarmGen == 'thresh'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'thresh'),
aes(x = xAlarm, y = trueAlarm), col = 'red', size = 1) +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm') +
ylim(0, 1)  +
ggtitle('Threshold Alarm')
p3 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 & alarmGen == 'hill'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'hill'),
aes(x = xAlarm, y = trueAlarm), col = 'red', size = 1) +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm')+
ylim(0, 1)  +
ggtitle('Hill Alarm')
pdf('./Figures/sim_alarms14.pdf', height = 7, width = 5)
grid.arrange(p1, p2, p3, nrow = 3,
top=textGrob("Alarm Functions Posterior Mean", gp = gpar(fontsize = 18, font = 1)))
dev.off()
pdf('./Figures/sim_alarms14.pdf', height = 6, width = 7)
grid.arrange(p1, p2, p3, nrow = 3,
top=textGrob("Alarm Functions Posterior Mean", gp = gpar(fontsize = 18, font = 1)))
dev.off()
pdf('./Figures/sim_alarms14.pdf', height = 6, width = 7)
grid.arrange(p1, p2, p3, nrow = 3,
top=textGrob("Alarm Functions Posterior Mean", gp = gpar(fontsize = 18, font = 1)))
dev.off()
pdf('./Figures/sim_alarms14.pdf', height = 7, width = 7)
grid.arrange(p1, p2, p3, nrow = 3,
top=textGrob("Alarm Functions Posterior Mean", gp = gpar(fontsize = 18, font = 1)))
dev.off()
theme_set(theme_bw() +
theme(strip.background = element_rect(fill = 'white'),
strip.text = element_text(size = 12),
axis.title = element_text(size = 12),
axis.text = element_text(size = 10),
plot.title = element_text(size = 14, h = 0.5)))
### smoothing window 14 days
p1 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 & alarmGen == 'power'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'power'),
aes(x = xAlarm, y = trueAlarm), col = 'red', size = 1) +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm')+
ylim(0, 1) +
ggtitle('Power Alarm')
p2 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 &  alarmGen == 'thresh'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'thresh'),
aes(x = xAlarm, y = trueAlarm), col = 'red', size = 1) +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm') +
ylim(0, 1)  +
ggtitle('Threshold Alarm')
p3 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 & alarmGen == 'hill'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'hill'),
aes(x = xAlarm, y = trueAlarm), col = 'red', size = 1) +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm')+
ylim(0, 1)  +
ggtitle('Hill Alarm')
pdf('./Figures/sim_alarms14.pdf', height = 7, width = 7)
grid.arrange(p1, p2, p3, nrow = 3,
top=textGrob("Alarm Functions Posterior Mean", gp = gpar(fontsize = 18, font = 1)))
dev.off()
pdf('./Figures/sim_alarms14.pdf', height = 6, width = 6)
grid.arrange(p1, p2, p3, nrow = 3,
top=textGrob("Alarm Functions Posterior Mean", gp = gpar(fontsize = 18, font = 1)))
dev.off()
theme_set(theme_bw() +
theme(strip.background = element_rect(fill = 'white'),
strip.text = element_text(size = 14),
axis.title = element_text(size = 14),
axis.text = element_text(size = 12),
plot.title = element_text(size = 14, h = 0.5)))
### smoothing window 14 days
p1 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 & alarmGen == 'power'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'power'),
aes(x = xAlarm, y = trueAlarm), col = 'red', size = 1) +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm')+
ylim(0, 1) +
ggtitle('Power Alarm')
p2 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 &  alarmGen == 'thresh'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'thresh'),
aes(x = xAlarm, y = trueAlarm), col = 'red', size = 1) +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm') +
ylim(0, 1)  +
ggtitle('Threshold Alarm')
p3 <- ggplot() +
geom_line(data = subset(alarmAll, smoothWindow == 14 & alarmGen == 'hill'),
aes(x = xAlarm, y = mean, group = simNumber),
col = adjustcolor('grey40', alpha = 0.5)) +
geom_line(data = subset(trueAlarms, smoothWindow == 14 & alarmGen == 'hill'),
aes(x = xAlarm, y = trueAlarm), col = 'red', size = 1) +
facet_wrap(~alarmFit) +
labs(x = '14-day average incidence', y = 'Alarm')+
ylim(0, 1)  +
ggtitle('Hill Alarm')
pdf('./Figures/sim_alarms14.pdf', height = 7, width = 7)
grid.arrange(p1, p2, p3, nrow = 3,
top=textGrob("Alarm Functions Posterior Mean", gp = gpar(fontsize = 18, font = 1)))
dev.off()
pdf('./Figures/sim_alarms14.pdf', height = 7, width = 7)
grid.arrange(p1, p2, p3, nrow = 3,
top=textGrob("Alarm Functions Posterior Mean", gp = gpar(fontsize = 16, font = 1)))
dev.off()
108-13
